# MxJSON Protocol Specification v1.0

> ä¼ä¸šçº§ AI èƒ½åŠ›å°è£…ä¸æ‰§è¡Œåè®®è§„èŒƒ

---

## ç›®å½•

1. [æ¦‚è¿°](#1-æ¦‚è¿°)
2. [è®¾è®¡åŸåˆ™](#2-è®¾è®¡åŸåˆ™)
3. [åè®®ç»“æ„](#3-åè®®ç»“æ„)
4. [å…ƒæ•°æ®è§„èŒƒ](#4-å…ƒæ•°æ®è§„èŒƒ)
5. [èƒ½åŠ›å®šä¹‰](#5-èƒ½åŠ›å®šä¹‰)
6. [è¾“å…¥è¾“å‡ºè§„èŒƒ](#6-è¾“å…¥è¾“å‡ºè§„èŒƒ)
7. [å·¥ä½œæµå¼•æ“](#7-å·¥ä½œæµå¼•æ“)
8. [äººå·¥å®¡æ ¸èŠ‚ç‚¹](#8-äººå·¥å®¡æ ¸èŠ‚ç‚¹)
9. [å®¡è®¡ä¸åˆè§„](#9-å®¡è®¡ä¸åˆè§„)
10. [å®šä»·ä¸è®¡è´¹](#10-å®šä»·ä¸è®¡è´¹)
11. [åŠ¨æ€UIæ¸²æŸ“](#11-åŠ¨æ€uiæ¸²æŸ“)
12. [é”™è¯¯å¤„ç†](#12-é”™è¯¯å¤„ç†)
13. [å®‰å…¨è§„èŒƒ](#13-å®‰å…¨è§„èŒƒ)
14. [æ‰©å±•æœºåˆ¶](#14-æ‰©å±•æœºåˆ¶)
15. [ç‰ˆæœ¬å…¼å®¹](#15-ç‰ˆæœ¬å…¼å®¹)
16. [è¿è¡Œæ—¶è¦æ±‚](#16-è¿è¡Œæ—¶è¦æ±‚)
17. [MXPåŒ…è§„èŒƒ](#17-mxpåŒ…è§„èŒƒ)
18. [æœ€ä½³å®è·µ](#18-æœ€ä½³å®è·µ)
19. [ç¤ºä¾‹é›†](#19-ç¤ºä¾‹é›†)
20. [æœ¯è¯­è¡¨](#20-æœ¯è¯­è¡¨)
21. [å˜æ›´æ—¥å¿—](#21-å˜æ›´æ—¥å¿—)

---

## 1. æ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯ MxJSONï¼Ÿ

MxJSON (Modular eXtensible JSON) æ˜¯ä¸€ç§å£°æ˜å¼åè®®ï¼Œç”¨äºå°† AI èƒ½åŠ›å°è£…ä¸ºæ ‡å‡†åŒ–ã€å¯ç§»æ¤ã€å¯äº¤æ˜“çš„èµ„äº§åŒ…ã€‚

### 1.2 æ ¸å¿ƒä»·å€¼ä¸»å¼ 

| ç‰¹æ€§ | æè¿° |
|------|------|
| **é€»è¾‘ä¸ç¯å¢ƒè§£è€¦** | ä¸€æ¬¡ç¼–å†™ï¼Œéšå¤„æ‰§è¡Œ |
| **ç¡®å®šæ€§äººæœºåä½œ** | ç²¾å‡†æ§åˆ¶äººå·¥ä»‹å…¥ç‚¹ |
| **ä¼ä¸šçº§å®¡è®¡** | åŸç”Ÿæ”¯æŒåˆè§„è¿½è¸ª |
| **å•†ä¸šåŒ–å°±ç»ª** | å†…ç½®å®šä»·è®¡è´¹é€»è¾‘ |
| **åŠ¨æ€UIæ¸²æŸ“** | åè®®é©±åŠ¨ç•Œé¢ç”Ÿæˆ |

### 1.3 é€‚ç”¨åœºæ™¯

- ä¼ä¸šå†…éƒ¨ AI èƒ½åŠ›æ ‡å‡†åŒ–
- AI èƒ½åŠ›å¸‚åœºäº¤æ˜“
- è·¨å¹³å° AI å·¥ä½œæµè¿ç§»
- åˆè§„å®¡è®¡è¦æ±‚é«˜çš„è¡Œä¸šåº”ç”¨

---

## 2. è®¾è®¡åŸåˆ™

### 2.1 å£°æ˜å¼ä¼˜å…ˆ

```json
{
  "capability": {
    "type": "prompt",
    "prompt": "è¯·å°†ä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆ{{target_language}}ï¼š\n{{content}}"
  }
}
```

### 2.2 å…³æ³¨ç‚¹åˆ†ç¦»

- **åè®®å±‚**ï¼šå®šä¹‰"åšä»€ä¹ˆ"
- **å¼•æ“å±‚**ï¼šå®ç°"æ€ä¹ˆåš"
- **é€‚é…å±‚**ï¼šå¤„ç†"åœ¨å“ªåš"

### 2.3 æ¸è¿›å¢å¼º

æœ€å°å¯è¡Œå®šä¹‰ï¼š

```json
{
  "version": "1.0.0",
  "metadata": { "id": "hello", "name": "Hello", "author": "Me" },
  "capability": { "type": "prompt", "prompt": "Say hello" }
}
```

---

## 3. åè®®ç»“æ„

### 3.1 é¡¶å±‚ç»“æ„

```json
{
  "version": "1.0.0",
  "metadata": {},
  "capability": {},
  "pricing": {},
  "audit": {},
  "human_review": {},
  "ui": {}
}
```

### 3.2 å¿…éœ€å­—æ®µ

| å­—æ®µ | ç±»å‹ | æè¿° |
|------|------|------|
| `version` | string | åè®®ç‰ˆæœ¬å· |
| `metadata` | object | å…ƒæ•°æ®ä¿¡æ¯ |
| `capability` | object | èƒ½åŠ›å®šä¹‰ |

### 3.3 å¯é€‰å­—æ®µ

| å­—æ®µ | ç±»å‹ | æè¿° |
|------|------|------|
| `pricing` | object | å®šä»·é…ç½® |
| `audit` | object | å®¡è®¡é…ç½® |
| `human_review` | object | äººå·¥å®¡æ ¸é…ç½® |
| `ui` | object | ç•Œé¢é…ç½® |

---

## 4. å…ƒæ•°æ®è§„èŒƒ

```json
{
  "metadata": {
    "id": "contract-review",
    "name": "åˆåŒé£é™©å®¡æ ¸",
    "author": "MxJSON Team",
    "description": "åŸºäºAIçš„åˆåŒé£é™©è‡ªåŠ¨è¯†åˆ«",
    "version": "1.0.0",
    "tags": ["legal", "contract", "risk"],
    "license": "MIT",
    "homepage": "https://github.com/xxx/mxjson-spec"
  }
}
```

---

## 5. èƒ½åŠ›å®šä¹‰

### 5.1 èƒ½åŠ›ç±»å‹

| ç±»å‹ | è¯´æ˜ |
|------|------|
| `prompt` | å•æ¬¡æç¤ºè¯è°ƒç”¨ |
| `workflow` | å¤šæ­¥éª¤å·¥ä½œæµ |
| `agent` | è‡ªä¸»å†³ç­–ä»£ç† |
| `tool` | å·¥å…·å‡½æ•°å°è£… |

### 5.2 Prompt ç±»å‹ç¤ºä¾‹

```json
{
  "capability": {
    "type": "prompt",
    "prompt": "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æ³•å¾‹é¡¾é—®...",
    "model": {
      "provider": "openai",
      "name": "gpt-4",
      "parameters": {
        "temperature": 0.3,
        "max_tokens": 2000
      }
    }
  }
}
```

---

## 6. è¾“å…¥è¾“å‡ºè§„èŒƒ

### 6.1 è¾“å…¥å®šä¹‰

```json
{
  "capability": {
    "inputs": {
      "contract_text": {
        "type": "string",
        "label": "åˆåŒå†…å®¹",
        "required": true,
        "validation": {
          "minLength": 100,
          "maxLength": 50000
        }
      }
    }
  }
}
```

### 6.2 è¾“å‡ºå®šä¹‰

```json
{
  "capability": {
    "outputs": {
      "risk_level": {
        "type": "string",
        "description": "é£é™©ç­‰çº§ï¼šhigh/medium/low"
      },
      "risk_items": {
        "type": "array",
        "description": "é£é™©æ¡æ¬¾åˆ—è¡¨"
      }
    }
  }
}
```

---

## 7. å·¥ä½œæµå¼•æ“

### 7.1 æ­¥éª¤ç±»å‹

| ç±»å‹ | è¯´æ˜ |
|------|------|
| `llm` | AI æ¨¡å‹è°ƒç”¨ |
| `tool` | å·¥å…·å‡½æ•°è°ƒç”¨ |
| `condition` | æ¡ä»¶åˆ†æ”¯ |
| `loop` | å¾ªç¯å¤„ç† |
| `human_review` | äººå·¥å®¡æ ¸ |
| `parallel` | å¹¶è¡Œæ‰§è¡Œ |

### 7.2 å·¥ä½œæµç¤ºä¾‹

```json
{
  "capability": {
    "type": "workflow",
    "steps": [
      {
        "id": "extract",
        "type": "llm",
        "name": "æå–å…³é”®æ¡æ¬¾",
        "next": "analyze"
      },
      {
        "id": "analyze",
        "type": "llm",
        "name": "é£é™©åˆ†æ",
        "next": "review"
      },
      {
        "id": "review",
        "type": "human_review",
        "name": "äººå·¥å¤æ ¸"
      }
    ]
  }
}
```

---

## 8. äººå·¥å®¡æ ¸èŠ‚ç‚¹

```json
{
  "human_review": {
    "enabled": true,
    "trigger": "confidence_threshold",
    "threshold": 0.8,
    "timeout_minutes": 60,
    "fallback_action": "escalate"
  }
}
```

---

## 9. å®¡è®¡ä¸åˆè§„

```json
{
  "audit": {
    "enabled": true,
    "retention_days": 365,
    "sensitive_fields": ["id_number", "phone", "bank_account"],
    "mask_pattern": "***"
  }
}
```

---

## 10. å®šä»·ä¸è®¡è´¹

```json
{
  "pricing": {
    "model": "per_call",
    "currency": "CNY",
    "price": 0.5,
    "unit": "call",
    "trial": {
      "enabled": true,
      "limit": 10
    }
  }
}
```

---

## 11. åŠ¨æ€UIæ¸²æŸ“

```json
{
  "ui": {
    "type": "form",
    "components": [
      {
        "type": "textarea",
        "id": "contract_input",
        "label": "è¯·ç²˜è´´åˆåŒå†…å®¹",
        "bind": "inputs.contract_text"
      },
      {
        "type": "button",
        "id": "submit",
        "label": "å¼€å§‹å®¡æ ¸"
      }
    ]
  }
}
```

---

## 12. é”™è¯¯å¤„ç†

### 12.1 é”™è¯¯ç è§„èŒƒ

| é”™è¯¯ç  | è¯´æ˜ |
|--------|------|
| `E001` | è¾“å…¥éªŒè¯å¤±è´¥ |
| `E002` | æ¨¡å‹è°ƒç”¨å¤±è´¥ |
| `E003` | è¶…æ—¶ |
| `E004` | æƒé™ä¸è¶³ |
| `E005` | é…é¢è€—å°½ |

---

## 13. å®‰å…¨è§„èŒƒ

- æ•æ„Ÿå­—æ®µå¿…é¡»å£°æ˜è„±æ•ç­–ç•¥
- æ”¯æŒå­—æ®µçº§åŠ å¯†
- å®¡è®¡æ—¥å¿—ä¸å¯ç¯¡æ”¹

---

## 14. æ‰©å±•æœºåˆ¶

æ”¯æŒé€šè¿‡ `extensions` å­—æ®µæ·»åŠ è‡ªå®šä¹‰æ‰©å±•ï¼š

```json
{
  "extensions": {
    "x-custom-feature": {
      "enabled": true
    }
  }
}
```

---

## 15. ç‰ˆæœ¬å…¼å®¹

éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ (SemVer)ï¼š
- ä¸»ç‰ˆæœ¬å·ï¼šä¸å…¼å®¹çš„åè®®å˜æ›´
- æ¬¡ç‰ˆæœ¬å·ï¼šå‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ–°å¢
- ä¿®è®¢å·ï¼šå‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®å¤

---

## 16. è¿è¡Œæ—¶è¦æ±‚

è¿è¡Œæ—¶å¼•æ“å¿…é¡»å®ç°ï¼š
- åè®®è§£æå™¨
- æ¨¡å‹é€‚é…å™¨
- å·¥ä½œæµè°ƒåº¦å™¨
- å®¡è®¡è®°å½•å™¨

---

## 17. MXPåŒ…è§„èŒƒ

### 17.1 ç›®å½•ç»“æ„

```
my-capability.mxp/
â”œâ”€â”€ manifest.mxjson      # èƒ½åŠ›å£°æ˜ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ prompts/             # æç¤ºè¯èµ„äº§
â”‚   â””â”€â”€ main.txt
â”œâ”€â”€ tools/               # å·¥å…·å®šä¹‰
â”œâ”€â”€ schemas/             # æ•°æ®ç»“æ„
â””â”€â”€ ui/                  # ç•Œé¢é…ç½®
```

### 17.2 æ‰“åŒ…æ ¼å¼

MXP æ–‡ä»¶æœ¬è´¨æ˜¯ ZIP å‹ç¼©åŒ…ï¼Œæ‰©å±•åä¸º `.mxp`

---

## 18. æœ€ä½³å®è·µ

1. **æ˜ç¡®å®šä¹‰è¾“å…¥è¾“å‡º** - æé«˜å¯å¤ç”¨æ€§
2. **åˆç†è®¾ç½®äººå·¥å®¡æ ¸ç‚¹** - å¹³è¡¡æ•ˆç‡ä¸é£é™©
3. **å¯ç”¨å®¡è®¡æ—¥å¿—** - æ»¡è¶³åˆè§„è¦æ±‚
4. **ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬** - ä¾¿äºå‡çº§ç®¡ç†

---

## 19. ç¤ºä¾‹é›†

è¯¦è§ `/examples` ç›®å½•ï¼š
- `contract-review/` - åˆåŒé£é™©å®¡æ ¸
- `translator/` - æ™ºèƒ½ç¿»è¯‘

---

## 20. æœ¯è¯­è¡¨

| æœ¯è¯­ | å®šä¹‰ |
|------|------|
| MxJSON | Modular eXtensible JSONï¼Œåè®®åç§° |
| MXP | MxJSON Packageï¼Œèƒ½åŠ›èµ„äº§åŒ… |
| Runtime | è¿è¡Œæ—¶å¼•æ“ |

---

## 21. å˜æ›´æ—¥å¿—

### v1.0.0 (2025-XX-XX)

- ğŸ‰ é¦–æ¬¡æ­£å¼å‘å¸ƒ
- âœ… å®Œæ•´åè®®è§„èŒƒ
- âœ… JSON Schema å®šä¹‰
- âœ… ç¤ºä¾‹èƒ½åŠ›åŒ…

---

**æ–‡æ¡£ç»´æŠ¤ï¼šMxJSON Team**

**æœ€åæ›´æ–°ï¼š2025å¹´**
